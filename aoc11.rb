require 'set'

space = ".................................#.....................................................#..............................................#.....
..........#.........#..........................................#............................................................................
..........................................................#.......................................................#............#............
..#.................................#........................................#.............#.........#...................#..................
..............#............................#..........#.........................................#..........#................................
.........................#......................#........................#..................................................................
.......................................#....................#...............................................................................
..............................#.................................................................................................#...........
...................#..............................................#...............#.....................#.........#........................#
..#......................................................#..................................................................................
.....................................#...................................................#.........#......................#.................
.......#...................................#.......#...................#......#.............................................................
.....................#.....................................................................................#..................#.......#.....
............................................................................................#...............................................
..........................#............#....................................................................................................
...................................................................................#..................#..........#...............#..........
#........................................................................................#............................#.....................
........#...........#...............#.............................#...........#.................#....................................#......
..............................#.............................#...............................................................................
.................................................#..........................................................................................
.....#............................................................................#......................#......................#..........#
................#..................................................................................#........................................
.........................................................................#..................#..............................#................
..#..............................................................#..........................................................................
.........................#...................................................................................#..........................#...
................................#......................................................................................#....................
.........#................................................#............#....................................................................
................#............................................................................#..........#...................................
.......................................#...........#...........................................................#...........................#
....................................................................................................................................#.......
...............................................................................#.............................................#..............
.....................#............................................................................................#.........................
.............................#.......................................................#........#..........#.............#....................
....................................#.......................................................................................................
.........................................#........#............#........#.................#.................................................
#.....................................................................................................................................#.....
.......................#.......#............................................................................................................
........................................................#.......................#...........................#...............................
...............#.....................................................................................#.................#....................
....#......................#....................................................................................................#...........
...................................#....................................#.................................................................#.
...........#...................................#.....#..............................#.............#.................#...............#.......
........................................#...................................................................................................
....................#..........#..............................................................#.............................................
......#...................................................................................................................#.................
.#.............................................................................................................................#............
............................................................................................................................................
.............#............#.................................................................#...............................................
...............................................................#.......................#....................................................
.............................................#..........#................#................................................................#.
............................................................................................................................................
.#.............................#.......................................................................#.............#.........#............
.............................................................#.....#.............#...............#..........................................
......#..............#..............#.......................................................................................................
.........................................................#..................................................................................
..............#.........................#.......................#...........................................................................
................................#.................#............................................................#...................#........
.............................................................................................#..............................................
............................................................................................................................................
........................#.................#.......................#..................#......................................................
..#.......................................................................................#................#.................#........#.....
.........#........#................#...............#.........#....................................#.........................................
............................................................................................................................................
........................................#..............................#.......................................#......#..........#..........
............................................................................................................................................
......................#......................................................#...........................#..................................
..#............#................#.......................#.....#...................................................#.........................
............................................................................................................................................
............................#...............................................................#........#......................................
............................................#...................................#......#..........................................#.........
...........#......................#..................#....................#....................................#............................
....................#..............................................#...................................................#....................
...........................................................................................................................................#
...#....................................#...............#.....#.....................#.......................................................
...............#.......#........................#...............................................#......#..............................#.....
.............................................................................................................................#..............
........................................................................................................................#...................
......#...............................................#........................#.................................................#..........
....................................................................................................................#....................#..
..#..........................................................#.........#...............#.....................#..............................
.....................#............................#.........................................#.....#.........................................
........#..........................#......#..............#...............................................................#...........#......
.............#....................................................................................................#.........................
................................................................#........................#..................................................
.........................................................................#............................#.......#.................#...........
............................................................................................................................................
.....................#...................#..................#.......#.................#.....#.............#............#....................
.......#......................................#.......#.....................................................................................
............................................................................................................................................
...............................#...............................#...................................................#...................#....
............................................................................................................................................
.....#.................................#...............................................#....................#................#..............
.................................................#......#...................................................................................
......................................................................#............................................................#........
.........#........#.......#........#................................................................................#.......................
..............................................#.............................................................................................
..#......................................#............#...........#...........................#...........................................#.
...............#............................................................................................................................
...........................................................................................................#................................
.............................#..........................................#................#..................................................
.....#......................................#..............#........................#...............................#.....#.............#...
.......................#.............#...............#......................................................................................
..................#.............#.................................#..........#..............................................................
................................................#.......................................................#........#.............#...........#
...#.......................#................................................................................................................
..............#............................#...............................................................................#................
........................................................#..............................#..........#..................#......................
..............................................................#...................#........................#................................
................................#...........................................................................................................
..#..............#.............................#...................#.........#....................................#............#............
...........#............................................................................................................................#...
......#............................................#...................#.................................#..................................
................................................................................#............#......#.......................................
....................#.......................#........................................#....................................#.........#.......
...............#.....................#......................................................................................................
.............................#..................................................................................#...........................
...#...................................................#..............#.........................#.......#...................................
...............................................................................#............................................................
.........................#.................................................................#.......................................#........
..............................................................#...............................................................#.............
........#............#.............#.........#.......#...............................................................#......................
.......................................................................#...............#...........#........................................
....#........#................#.........#.......................................#........................#..................................
..............................................................................................................#.............#...............
............................................................................................................................................
.........................#.....................................#..........#.......................................................#.........
.........#...................................#..............................................................................................
.......................................#..........#.........................................................#...............................
.#............#............................................#..........#................#...........................#........................
............................................................................................................................................
........................................................................................................#...............................#...
......#............................#...........................#..............................#..................................#..........
......................#..........................................................................................#......#...................
............................................#.....#......................#...........................#......................................
...............#............#............................#.........................#........................................................
........................................#............................................................................#......................
........#...........................................................#...................#......................#..................#.........
........................#.............................#............................................#........................................
...............................#.............#..............#.............................................................#.................
.................#............................................................................#.........................................#...".split("\n").map { |line| line.split("") }

galaxies = []
rows = [0]
cols = [0]

space.each do |row|
    if row.all? { |char| char == '.' }
        rows << rows[-1] + 1000000
    else
        rows << rows[-1] + 1
    end
end

(0...space[0].length).each do |j|
    if (0...space.length).all? { |i| space[i][j] == '.' }
        cols << cols[-1] + 1000000
    else
        cols << cols[-1] + 1
    end
end

rows.shift
cols.shift

space.each_with_index do |line,i|
    line.each_with_index { |pos,j| galaxies << [i,j] if pos == '#' }
end

total = 0
(0...galaxies.length).each do |i|
    (0...i).each do |j|
        a,b = galaxies[i]
        c,d = galaxies[j]
        total += (rows[a]-rows[c]).abs + (cols[b]-cols[d]).abs
    end
end

p total